openapi: 3.0.3
info:
  title: Auto Forex Trading API
  version: 1.0.0
  description: API for managing algorithmic forex trading operations across multiple
    OANDA accounts
  contact:
    name: Auto Forex Support
    email: support@autoforex.example.com
  license:
    name: Proprietary
paths:
  /api/accounts/auth/login:
    post:
      operationId: accounts_auth_login_create
      description: Authenticate user with email and password. Returns JWT token on
        success. Rate limited to 5 attempts per 15 minutes per IP address.
      summary: POST /api/accounts/auth/login
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserLoginRequest'
        required: true
      security:
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                      username:
                        type: string
                      is_staff:
                        type: boolean
                      timezone:
                        type: string
                      language:
                        type: string
          description: Login successful
        '401':
          description: Invalid credentials
        '403':
          description: Account locked or email not whitelisted
        '429':
          description: Too many failed login attempts
        '503':
          description: Login is disabled
  /api/accounts/auth/logout:
    post:
      operationId: accounts_auth_logout_create
      description: Logout user and terminate all active sessions. Requires valid JWT
        token in Authorization header.
      summary: POST /api/accounts/auth/logout
      tags:
      - Authentication
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  sessions_terminated:
                    type: integer
          description: Logout successful
        '401':
          description: Invalid or expired token
  /api/accounts/auth/refresh:
    post:
      operationId: accounts_auth_refresh_create
      description: Refresh an existing JWT token to extend its expiration time. Requires
        valid JWT token in Authorization header.
      summary: POST /api/accounts/auth/refresh
      tags:
      - Authentication
      security:
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                      username:
                        type: string
                      is_staff:
                        type: boolean
                      timezone:
                        type: string
                      language:
                        type: string
          description: Token refreshed successfully
        '401':
          description: Invalid or expired token
        '500':
          description: Failed to retrieve user information
  /api/accounts/auth/register:
    post:
      operationId: accounts_auth_register_create
      description: Register a new user account and send email verification link.
      summary: POST /api/accounts/auth/register
      tags:
      - Authentication
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserRegistrationRequest'
        required: true
      security:
      - {}
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                      username:
                        type: string
                      first_name:
                        type: string
                      last_name:
                        type: string
                      email_verified:
                        type: boolean
                  email_sent:
                    type: boolean
          description: User registered successfully
        '400':
          description: Validation error
        '503':
          description: Registration is disabled
  /api/accounts/auth/resend-verification:
    post:
      operationId: accounts_auth_resend_verification_create
      description: Resend email verification link to the specified email address.
      summary: POST /api/accounts/auth/resend-verification
      tags:
      - Authentication
      requestBody:
        content:
          type:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
          properties:
            schema:
              email:
                type: string
                format: email
          required:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
      security:
      - {}
      responses:
        '200':
          description: Verification email sent
        '400':
          description: Email is required or already verified
  /api/accounts/auth/verify-email:
    post:
      operationId: accounts_auth_verify_email_create
      description: Verify user email address using the verification token sent via
        email.
      summary: POST /api/accounts/auth/verify-email
      tags:
      - Authentication
      requestBody:
        content:
          type:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
          properties:
            schema:
              token:
                type: string
          required:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
      security:
      - {}
      responses:
        '200':
          description: Email verified successfully
        '400':
          description: Invalid or expired token
  /api/accounts/notifications:
    get:
      operationId: accounts_notifications_retrieve
      description: Retrieve list of notifications for the authenticated user. Supports
        filtering by read status and limiting results.
      summary: GET /api/accounts/notifications
      parameters:
      - in: query
        name: limit
        schema:
          type: integer
        description: 'Maximum number of notifications to return (1-200, default: 50)'
      - in: query
        name: unread_only
        schema:
          type: boolean
        description: Filter to show only unread notifications
      tags:
      - Notifications
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                    title:
                      type: string
                    message:
                      type: string
                    severity:
                      type: string
                      enum:
                      - info
                      - warning
                      - error
                      - critical
                    timestamp:
                      type: string
                      format: date-time
                    read:
                      type: boolean
                    notification_type:
                      type: string
                    extra_data:
                      type: object
          description: Notifications retrieved successfully
        '401':
          description: Authentication required
        '500':
          description: Failed to retrieve notifications
  /api/accounts/notifications/{notification_id}/read:
    post:
      operationId: accounts_notifications_read_create
      description: Mark a single notification as read for the authenticated user.
      summary: POST /api/accounts/notifications/{notification_id}/read
      parameters:
      - in: path
        name: notification_id
        schema:
          type: integer
        description: ID of the notification to mark as read
        required: true
      tags:
      - Notifications
      security:
      - cookieAuth: []
      responses:
        '200':
          description: Notification marked as read
        '401':
          description: Authentication required
        '404':
          description: Notification not found
        '500':
          description: Failed to mark notification as read
  /api/accounts/notifications/read-all:
    post:
      operationId: accounts_notifications_read_all_create
      description: Mark all unread notifications as read for the authenticated user.
      summary: POST /api/accounts/notifications/read-all
      tags:
      - Notifications
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  count:
                    type: integer
          description: All notifications marked as read
        '401':
          description: Authentication required
        '500':
          description: Failed to mark all notifications as read
  /api/accounts/settings/:
    get:
      operationId: accounts_settings_retrieve
      description: Retrieve user profile and settings including timezone, language,
        and notification preferences.
      summary: GET /api/accounts/settings/
      tags:
      - User Settings
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      username:
                        type: string
                      email:
                        type: string
                      first_name:
                        type: string
                      last_name:
                        type: string
                  settings:
                    type: object
                    properties:
                      timezone:
                        type: string
                      language:
                        type: string
                      notifications_enabled:
                        type: boolean
          description: ''
        '401':
          description: Authentication required
    put:
      operationId: accounts_settings_update
      description: Update user profile and settings. Can update timezone, language,
        notification preferences, etc.
      summary: PUT /api/accounts/settings/
      tags:
      - User Settings
      requestBody:
        content:
          type:
            schema:
              type: object
              additionalProperties: {}
              description: Unspecified request body
          properties:
            schema:
              timezone:
                type: string
              language:
                type: string
                enum:
                - en
                - ja
              first_name:
                type: string
              last_name:
                type: string
              username:
                type: string
              notification_enabled:
                type: boolean
              notification_email:
                type: boolean
              notification_browser:
                type: boolean
              settings_json:
                type: object
      security:
      - cookieAuth: []
      responses:
        '200':
          description: Settings updated successfully
        '400':
          description: Validation error
        '401':
          description: Authentication required
  /api/accounts/settings/public:
    get:
      operationId: accounts_settings_public_retrieve
      description: Retrieve public account settings including registration and login
        availability. No authentication required.
      summary: GET /api/accounts/settings/public
      tags:
      - Public Settings
      security:
      - cookieAuth: []
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicAccountSettings'
          description: Public settings retrieved successfully
  /api/health/:
    get:
      operationId: health_check
      description: Check the health status of the backend API service. Returns overall
        system status.
      summary: GET /api/health/
      tags:
      - health
      security:
      - {}
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                    - healthy
                    description: Overall health status
                  timestamp:
                    type: string
                    format: date-time
                    description: Timestamp of the health check
                  response_time_ms:
                    type: integer
                    description: Response time in milliseconds
                required:
                - status
                - timestamp
                - response_time_ms
                example:
                  status: healthy
                  timestamp: '2024-01-18T12:00:00Z'
                  response_time_ms: 15
          description: Service is healthy
        '503':
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum:
                    - unhealthy
                    description: Overall health status
                  timestamp:
                    type: string
                    format: date-time
                    description: Timestamp of the health check
                  response_time_ms:
                    type: integer
                    description: Response time in milliseconds
                required:
                - status
                - timestamp
                - response_time_ms
                example:
                  status: unhealthy
                  timestamp: '2024-01-18T12:00:00Z'
                  response_time_ms: 20
          description: Service is unhealthy
  /api/market/accounts/:
    get:
      operationId: list_oanda_accounts
      description: Retrieve all OANDA accounts for the authenticated user
      summary: GET /api/market/accounts/
      tags:
      - Market - Accounts
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OandaAccounts'
          description: List of OANDA accounts
        '401':
          description: Authentication required
    post:
      operationId: create_oanda_account
      description: Add a new OANDA account for the authenticated user
      summary: POST /api/market/accounts/
      tags:
      - Market - Accounts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OandaAccountsRequest'
        required: true
      security:
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OandaAccounts'
          description: Account created successfully
        '400':
          description: Invalid data
        '401':
          description: Authentication required
  /api/market/accounts/{account_id}/:
    get:
      operationId: get_oanda_account_detail
      description: Retrieve detailed information about a specific OANDA account including
        live data from OANDA API
      summary: GET /api/market/accounts/{account_id}/
      parameters:
      - in: path
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
        required: true
      tags:
      - Market - Accounts
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OandaAccounts'
          description: Account details retrieved successfully
        '401':
          description: Authentication required
        '404':
          description: Account not found
    put:
      operationId: update_oanda_account
      description: Update a specific OANDA account
      summary: PUT /api/market/accounts/{account_id}/
      parameters:
      - in: path
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
        required: true
      tags:
      - Market - Accounts
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OandaAccountsRequest'
        required: true
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OandaAccounts'
          description: Account updated successfully
        '400':
          description: Invalid data
        '401':
          description: Authentication required
        '404':
          description: Account not found
    delete:
      operationId: delete_oanda_account
      description: Delete a specific OANDA account
      summary: DELETE /api/market/accounts/{account_id}/
      parameters:
      - in: path
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
        required: true
      tags:
      - Market - Accounts
      security:
      - cookieAuth: []
      responses:
        '200':
          description: Account deleted successfully
        '400':
          description: Account is in use
        '401':
          description: Authentication required
        '404':
          description: Account not found
  /api/market/candles/:
    get:
      operationId: get_candle_data
      description: Fetch historical candle data from OANDA for charting and analysis
      summary: GET /api/market/candles/
      parameters:
      - in: query
        name: account_id
        schema:
          type: string
        description: OANDA account ID (uses default if not provided)
      - in: query
        name: after
        schema:
          type: integer
        description: Unix timestamp for fetching newer data
      - in: query
        name: before
        schema:
          type: integer
        description: Unix timestamp for fetching older data
      - in: query
        name: count
        schema:
          type: integer
          default: 100
        description: Number of candles to fetch (1-5000)
      - in: query
        name: from_time
        schema:
          type: string
        description: Start time in RFC3339 format
      - in: query
        name: granularity
        schema:
          type: string
          default: H1
        description: Candle granularity (S5, M1, H1, D, etc.)
      - in: query
        name: instrument
        schema:
          type: string
        description: Currency pair (e.g., EUR_USD, GBP_USD)
        required: true
      - in: query
        name: to_time
        schema:
          type: string
        description: End time in RFC3339 format
      tags:
      - market
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/candles/granularities/:
    get:
      operationId: list_supported_granularities
      description: Retrieve list of supported OANDA granularities/timeframes
      summary: GET /api/market/granularities/
      tags:
      - market
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/health/oanda/:
    get:
      operationId: get_oanda_health_status
      description: Retrieve the latest health check status for the selected OANDA
        account
      summary: GET /api/market/health/oanda/
      parameters:
      - in: query
        name: account_id
        schema:
          type: string
        description: OANDA account ID (uses default if not provided)
      tags:
      - Market - Health
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OandaApiHealthStatus'
          description: Health status retrieved successfully
        '400':
          description: No OANDA account found
    post:
      operationId: check_oanda_health
      description: Perform a live health check against OANDA API and persist the result
      summary: POST /api/market/health/oanda/
      parameters:
      - in: query
        name: account_id
        schema:
          type: string
        description: OANDA account ID (uses default if not provided)
      tags:
      - Market - Health
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OandaApiHealthStatus'
          description: Health check performed successfully
        '400':
          description: No OANDA account found
  /api/market/instruments/:
    get:
      operationId: list_supported_instruments
      description: Retrieve list of supported currency pairs from OANDA API
      summary: GET /api/market/instruments/
      tags:
      - market
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/instruments/{instrument}/:
    get:
      operationId: get_instrument_detail
      description: Fetch detailed information about a specific currency pair
      summary: GET /api/market/instruments/{instrument}/
      parameters:
      - in: path
        name: instrument
        schema:
          type: string
        description: Currency pair (e.g., EUR_USD)
        required: true
      tags:
      - market
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/market/status/:
    get:
      operationId: get_market_status
      description: Retrieve current forex market open/close status and trading session
        information
      summary: GET /api/market/status/
      tags:
      - market
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/orders/:
    get:
      operationId: list_orders
      description: List user's orders directly from OANDA API
      summary: GET /api/market/orders/
      parameters:
      - in: query
        name: account_id
        schema:
          type: integer
        description: Filter by OANDA account ID
      - in: query
        name: count
        schema:
          type: integer
          default: 50
        description: Number of orders to return
      - in: query
        name: instrument
        schema:
          type: string
        description: Filter by currency pair
      - in: query
        name: status
        schema:
          type: string
          default: all
        description: Filter by order status (pending/all)
      tags:
      - Market - Orders
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    post:
      operationId: create_order
      description: Submit new order (market, limit, stop, OCO)
      summary: POST /api/market/orders/
      tags:
      - Market - Orders
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrderRequest'
        required: true
      security:
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/orders/{order_id}/:
    get:
      operationId: get_order_detail
      description: Retrieve order details from OANDA API
      summary: GET /api/market/orders/{order_id}/
      parameters:
      - in: query
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
        required: true
      - in: path
        name: order_id
        schema:
          type: string
        description: OANDA Order ID
        required: true
      tags:
      - Market - Orders
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    delete:
      operationId: cancel_order
      description: Cancel a pending order via OANDA API
      summary: DELETE /api/market/orders/{order_id}/
      parameters:
      - in: query
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
        required: true
      - in: path
        name: order_id
        schema:
          type: string
        description: OANDA Order ID
        required: true
      tags:
      - Market - Orders
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/positions/:
    get:
      operationId: list_positions
      description: Retrieve positions directly from OANDA API
      summary: GET /api/market/positions/
      parameters:
      - in: query
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
      - in: query
        name: instrument
        schema:
          type: string
        description: Currency pair filter
      - in: query
        name: status
        schema:
          type: string
          default: open
        description: Position status (open/closed/all)
      tags:
      - Market - Positions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    put:
      operationId: open_position
      description: Open a new position by submitting a market order via OANDA
      summary: PUT /api/market/positions/
      tags:
      - Market - Positions
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PositionRequest'
        required: true
      security:
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/market/positions/{position_id}/:
    get:
      operationId: get_position_detail
      description: Retrieve detailed information for a specific trade/position from
        OANDA
      summary: GET /api/market/positions/{position_id}/
      parameters:
      - in: query
        name: account_id
        schema:
          type: integer
        description: OANDA account database ID
        required: true
      - in: path
        name: position_id
        schema:
          type: string
        description: OANDA Trade ID
        required: true
      tags:
      - Market - Positions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
    patch:
      operationId: close_position
      description: Close a position via OANDA API
      summary: PATCH /api/market/positions/{position_id}/
      parameters:
      - in: path
        name: position_id
        schema:
          type: string
        description: OANDA Trade ID
        required: true
      tags:
      - Market - Positions
      requestBody:
        content:
          application/json:
            schema:
              type: object
              additionalProperties: {}
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                type: object
                additionalProperties: {}
          description: ''
  /api/trading/backtest-tasks/:
    get:
      operationId: trading_backtest_tasks_list
      description: List and create backtest tasks.
      parameters:
      - in: query
        name: config_id
        schema:
          type: integer
        description: Filter by configuration ID
      - in: query
        name: ordering
        schema:
          type: string
        description: Order results by field (prefix with - for descending)
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: search
        schema:
          type: string
        description: Search in name or description
      - in: query
        name: status
        schema:
          type: string
        description: Filter by task status
      - in: query
        name: strategy_type
        schema:
          type: string
        description: Filter by strategy type
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedBacktestTaskListList'
          description: ''
    post:
      operationId: trading_backtest_tasks_create
      description: List and create backtest tasks.
      tags:
      - trading
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BacktestTaskCreateRequest'
        required: true
      security:
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestTaskCreate'
          description: ''
  /api/trading/backtest-tasks/{task_id}/:
    get:
      operationId: trading_backtest_tasks_retrieve
      description: Retrieve, update, or delete a backtest task.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestTask'
          description: ''
    put:
      operationId: trading_backtest_tasks_update
      description: Retrieve, update, or delete a backtest task.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BacktestTaskCreateRequest'
        required: true
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestTaskCreate'
          description: ''
    patch:
      operationId: trading_backtest_tasks_partial_update
      description: Retrieve, update, or delete a backtest task.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedBacktestTaskCreateRequest'
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BacktestTaskCreate'
          description: ''
    delete:
      operationId: trading_backtest_tasks_destroy
      description: Retrieve, update, or delete a backtest task.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/copy/:
    post:
      operationId: trading_backtest_tasks_copy_create
      description: Copy backtest task.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/executions/:
    get:
      operationId: trading_backtest_tasks_executions_retrieve
      description: Get execution history for backtest task.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/restart/:
    post:
      operationId: trading_backtest_tasks_restart_create
      description: Restart backtest task with fresh state.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/resume/:
    post:
      operationId: trading_backtest_tasks_resume_create
      description: Resume backtest task execution.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/start/:
    post:
      operationId: trading_backtest_tasks_start_create
      description: Start backtest task execution.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/status/:
    get:
      operationId: trading_backtest_tasks_status_retrieve
      description: Get current task status and execution details.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/backtest-tasks/{task_id}/stop/:
    post:
      operationId: trading_backtest_tasks_stop_create
      description: Stop backtest task execution.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/executions/{execution_id}/:
    get:
      operationId: get_execution_detail
      description: Retrieve complete details for a specific execution including status,
        timing, resource usage, and logs.
      summary: Get execution details
      parameters:
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Execution details retrieved successfully
                content:
                  application/json:
                    example:
                      id: 1
                      task_type: backtest
                      task_id: 123
                      execution_number: 1
                      status: completed
                      progress: 100.0
                      started_at: '2024-01-01T00:00:00Z'
                      completed_at: '2024-01-01T01:00:00Z'
                      duration: 3600
                      cpu_limit_cores: 2.0
                      memory_limit_mb: '2048'
                      peak_memory_mb: '1536'
                      error_message: null
                      error_traceback: null
                      logs: []
                      created_at: '2024-01-01T00:00:00Z'
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied - user does not own this execution's task
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/equity/:
    get:
      operationId: get_execution_equity
      description: Retrieve equity curve data with configurable time granularity for
        binning and statistical aggregation.
      summary: Get execution equity curve
      parameters:
      - in: query
        name: end_time
        schema:
          type: string
          format: date-time
        description: Filter data before this timestamp (ISO format)
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      - in: query
        name: granularity
        schema:
          type: integer
        description: 'Time window in seconds for binning (default: 60)'
      - in: query
        name: start_time
        schema:
          type: string
          format: date-time
        description: Filter data after this timestamp (ISO format)
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Equity curve data retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      granularity_seconds: 60
                      bins:
                      - timestamp: '2024-01-01T00:00:00Z'
                        realized_pnl_min: '100.0'
                        realized_pnl_max: '150.0'
                        realized_pnl_avg: '125.0'
                        realized_pnl_median: '120.0'
                        unrealized_pnl_min: '-50.0'
                        unrealized_pnl_max: '50.0'
                        unrealized_pnl_avg: '10.0'
                        unrealized_pnl_median: '5.0'
                        tick_ask_min: '1.1000'
                        tick_ask_max: '1.1050'
                        tick_ask_avg: '1.1025'
                        tick_ask_median: '1.1020'
                        tick_bid_min: '1.0990'
                        tick_bid_max: '1.1040'
                        tick_bid_avg: '1.1015'
                        tick_bid_median: '1.1010'
                        tick_mid_min: '1.0995'
                        tick_mid_max: '1.1045'
                        tick_mid_avg: '1.1020'
                        tick_mid_median: '1.1015'
                        trade_count: 5
                      count: 1
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid parameters
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/events/:
    get:
      operationId: get_execution_events
      description: Retrieve strategy events with optional filtering by event type
        and incremental fetching support.
      summary: Get execution strategy events
      parameters:
      - in: query
        name: event_type
        schema:
          type: string
        description: Filter by event type
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      - in: query
        name: since_sequence
        schema:
          type: integer
        description: Return only events with sequence number greater than this value
          (for incremental fetching)
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Events retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      events:
                      - sequence: 1
                        event_type: signal_generated
                        strategy_type: floor
                        timestamp: '2024-01-01T00:00:00Z'
                        event: {}
                        created_at: '2024-01-01T00:00:00Z'
                      count: 1
                      next: null
                      previous: null
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid parameters
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/logs/:
    get:
      operationId: get_execution_logs
      description: Retrieve execution logs with optional filtering by level, time
        range, and limit.
      summary: Get execution logs
      parameters:
      - in: query
        name: end_time
        schema:
          type: string
          format: date-time
        description: Filter logs before this timestamp (ISO format)
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      - in: query
        name: level
        schema:
          type: string
          enum:
          - debug
          - error
          - info
          - warning
        description: Filter by log level (debug, info, warning, error)
      - in: query
        name: limit
        schema:
          type: integer
        description: 'Maximum number of logs to return (default: 100, max: 1000)'
      - in: query
        name: start_time
        schema:
          type: string
          format: date-time
        description: Filter logs after this timestamp (ISO format)
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Logs retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      logs:
                      - timestamp: '2024-01-01T00:00:00Z'
                        level: info
                        message: Strategy initialized
                      count: 1
                      next: null
                      previous: null
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/metrics/:
    get:
      operationId: get_execution_metrics
      description: Retrieve metrics data with optional granularity binning, time range
        filtering, or last N points.
      summary: Get execution metrics
      parameters:
      - in: query
        name: end_time
        schema:
          type: string
          format: date-time
        description: Filter metrics before this timestamp (ISO format)
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      - in: query
        name: granularity
        schema:
          type: integer
        description: Time window in seconds for binning (optional, returns binned
          data if provided)
      - in: query
        name: last_n
        schema:
          type: integer
        description: Return last N metrics points (alternative to time range)
      - in: query
        name: start_time
        schema:
          type: string
          format: date-time
        description: Filter metrics after this timestamp (ISO format)
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Metrics retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      metrics:
                      - sequence: 1
                        timestamp: '2024-01-01T00:00:00Z'
                        realized_pnl: '100.0'
                        unrealized_pnl: '50.0'
                        total_pnl: '150.0'
                        open_positions: 2
                        total_trades: 5
                      count: 1
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid parameters
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/metrics/latest/:
    get:
      operationId: get_execution_latest_metrics
      description: Retrieve the most recent metrics snapshot for an execution.
      summary: Get latest execution metrics
      parameters:
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Latest metrics retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      has_metrics: true
                      metrics:
                        sequence: 100
                        timestamp: '2024-01-01T01:00:00Z'
                        realized_pnl: '500.0'
                        unrealized_pnl: '100.0'
                        total_pnl: '600.0'
                        open_positions: 3
                        total_trades: 25
                        tick_ask_min: '1.1000'
                        tick_ask_max: '1.1050'
                        tick_ask_avg: '1.1025'
                        tick_bid_min: '1.0990'
                        tick_bid_max: '1.1040'
                        tick_bid_avg: '1.1015'
                        tick_mid_min: '1.0995'
                        tick_mid_max: '1.1045'
                        tick_mid_avg: '1.1020'
                        created_at: '2024-01-01T01:00:00Z'
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/status/:
    get:
      operationId: get_execution_status
      description: Retrieve current execution status including progress, timing, and
        estimated completion.
      summary: Get execution status
      parameters:
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Status retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      execution_number: 1
                      status: running
                      progress: 75.0
                      started_at: '2024-01-01T00:00:00Z'
                      completed_at: null
                      error_message: null
                      estimated_remaining_seconds: 1200
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/executions/{execution_id}/trades/:
    get:
      operationId: get_execution_trades
      description: Retrieve trade logs with optional filtering by instrument, direction,
        and incremental fetching support.
      summary: Get execution trades
      parameters:
      - in: query
        name: direction
        schema:
          type: string
          enum:
          - buy
          - sell
        description: Filter by trade direction (buy/sell)
      - in: path
        name: execution_id
        schema:
          type: integer
        required: true
      - in: query
        name: instrument
        schema:
          type: string
        description: Filter by instrument (e.g., EUR_USD)
      - in: query
        name: since_sequence
        schema:
          type: integer
        description: Return only trades with sequence number greater than this value
          (for incremental fetching)
      tags:
      - executions
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                description: Trades retrieved successfully
                content:
                  application/json:
                    example:
                      execution_id: 1
                      task_type: backtest
                      task_id: 123
                      trades:
                      - sequence: 1
                        trade:
                          instrument: EUR_USD
                          direction: buy
                          units: 1000
                        created_at: '2024-01-01T00:00:00Z'
                      count: 1
                      next: null
                      previous: null
          description: ''
        '400':
          content:
            application/json:
              schema:
                description: Invalid parameters
          description: ''
        '403':
          content:
            application/json:
              schema:
                description: Access denied
          description: ''
        '404':
          content:
            application/json:
              schema:
                description: Execution not found
          description: ''
  /api/trading/strategies/:
    get:
      operationId: trading_strategies_retrieve
      description: API endpoint for listing all available trading strategies.
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/strategies/{strategy_id}/defaults/:
    get:
      operationId: trading_strategies_defaults_retrieve
      description: API endpoint for returning default parameters for a strategy.
      parameters:
      - in: path
        name: strategy_id
        schema:
          type: string
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/strategy-configs/:
    get:
      operationId: trading_strategy_configs_retrieve
      description: List and create strategy configurations.
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
    post:
      operationId: trading_strategy_configs_create
      description: List and create strategy configurations.
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/strategy-configs/{config_id}/:
    get:
      operationId: trading_strategy_configs_retrieve_2
      description: Retrieve, update, and delete a strategy configuration.
      parameters:
      - in: path
        name: config_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
    put:
      operationId: trading_strategy_configs_update
      description: Retrieve, update, and delete a strategy configuration.
      parameters:
      - in: path
        name: config_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
    delete:
      operationId: trading_strategy_configs_destroy
      description: Retrieve, update, and delete a strategy configuration.
      parameters:
      - in: path
        name: config_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/trading/trading-tasks/:
    get:
      operationId: trading_trading_tasks_list
      description: |-
        List and create trading tasks.

        GET: List all trading tasks for the authenticated user with filtering and pagination
        POST: Create a new trading task
      parameters:
      - in: query
        name: config_id
        schema:
          type: integer
        description: Filter by configuration ID
      - in: query
        name: ordering
        schema:
          type: string
        description: Order results by field (prefix with - for descending)
      - in: query
        name: page
        schema:
          type: integer
        description: Page number
      - in: query
        name: search
        schema:
          type: string
        description: Search in name or description
      - in: query
        name: status
        schema:
          type: string
        description: Filter by task status
      - in: query
        name: strategy_type
        schema:
          type: string
        description: Filter by strategy type
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedTradingTaskListList'
          description: ''
    post:
      operationId: trading_trading_tasks_create
      description: |-
        List and create trading tasks.

        GET: List all trading tasks for the authenticated user with filtering and pagination
        POST: Create a new trading task
      tags:
      - trading
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TradingTaskCreateRequest'
      security:
      - cookieAuth: []
      responses:
        '201':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradingTaskCreate'
          description: ''
  /api/trading/trading-tasks/{task_id}/:
    get:
      operationId: trading_trading_tasks_retrieve
      description: |-
        Retrieve, update, or delete a trading task.

        GET: Retrieve trading task details
        PUT/PATCH: Update trading task
        DELETE: Delete trading task
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradingTask'
          description: ''
    put:
      operationId: trading_trading_tasks_update
      description: |-
        Retrieve, update, or delete a trading task.

        GET: Retrieve trading task details
        PUT/PATCH: Update trading task
        DELETE: Delete trading task
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TradingTaskCreateRequest'
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradingTaskCreate'
          description: ''
    patch:
      operationId: trading_trading_tasks_partial_update
      description: |-
        Retrieve, update, or delete a trading task.

        GET: Retrieve trading task details
        PUT/PATCH: Update trading task
        DELETE: Delete trading task
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatchedTradingTaskCreateRequest'
      security:
      - cookieAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TradingTaskCreate'
          description: ''
    delete:
      operationId: trading_trading_tasks_destroy
      description: |-
        Retrieve, update, or delete a trading task.

        GET: Retrieve trading task details
        PUT/PATCH: Update trading task
        DELETE: Delete trading task
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '204':
          description: No response body
  /api/trading/trading-tasks/{task_id}/copy/:
    post:
      operationId: trading_trading_tasks_copy_create
      description: |-
        Copy trading task.

        Request body:
        - new_name: Name for the copied task (required)
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/trading-tasks/{task_id}/executions/:
    get:
      operationId: trading_trading_tasks_executions_retrieve
      description: |-
        Get execution history for trading task.

        Returns all executions ordered by execution number (most recent first).
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/trading-tasks/{task_id}/restart/:
    post:
      operationId: trading_trading_tasks_restart_create
      description: |-
        Restart trading task with fresh state.

        Clears strategy_state and starts a new execution. Task can be in any
        state (stopped, failed) to be restarted, but not running or paused.

        Request body:
            - clear_state: bool (default: True) - Clear strategy state
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/trading-tasks/{task_id}/resume/:
    post:
      operationId: trading_trading_tasks_resume_create
      description: Resume trading task execution.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/trading-tasks/{task_id}/start/:
    post:
      operationId: trading_trading_tasks_start_create
      description: |-
        Start trading task execution.

        Validates task status in database AND checks celery task lock status
        before starting. Creates a new TaskExecution and queues the trading
        task for processing. Enforces one active task per account constraint.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/trading-tasks/{task_id}/status/:
    get:
      operationId: trading_trading_tasks_status_retrieve
      description: |-
        Get current task status and execution details.

        Used by frontend for polling fallback when WebSocket connection fails.
        Returns current status, progress percentage, and latest execution details.
        Also detects and auto-completes stale running/stopped tasks.
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
  /api/trading/trading-tasks/{task_id}/stop/:
    post:
      operationId: trading_trading_tasks_stop_create
      description: |-
        Stop trading task execution.

        Validates task status in database AND checks celery task lock status
        before stopping. Updates task to stopped state and triggers cleanup.

        Request body (optional):
        - mode: Stop mode ('immediate', 'graceful', 'graceful_close')
                Default: 'graceful'
      parameters:
      - in: path
        name: task_id
        schema:
          type: integer
        required: true
      tags:
      - trading
      security:
      - cookieAuth: []
      responses:
        '200':
          description: No response body
components:
  schemas:
    ApiTypeEnum:
      enum:
      - practice
      - live
      type: string
      description: |-
        * `practice` - Practice
        * `live` - Live
    BacktestTask:
      type: object
      description: Serializer for BacktestTasks full details.
      properties:
        id:
          type: integer
          readOnly: true
        user_id:
          type: integer
          readOnly: true
        config_id:
          type: integer
          readOnly: true
        config_name:
          type: string
          readOnly: true
        strategy_type:
          type: string
          readOnly: true
        name:
          type: string
          description: Human-readable name for this backtest task
          maxLength: 255
        description:
          type: string
          description: Optional description of this backtest task
        data_source:
          allOf:
          - $ref: '#/components/schemas/DataSourceEnum'
          description: |-
            Data source for historical tick data

            * `postgresql` - PostgreSQL
            * `athena` - AWS Athena
            * `s3` - AWS S3
        start_time:
          type: string
          format: date-time
          description: Start time for backtest period
        end_time:
          type: string
          format: date-time
          description: End time for backtest period
        initial_balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          description: Initial account balance for backtest
        commission_per_trade:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Commission to apply per trade
        pip_size:
          type: number
          format: double
          description: |-
            Get pip_size as Decimal with default value.

            Returns:
                Decimal: Pip size for the instrument, defaults to 0.01 if not set

            Example:
                >>> task = BacktestTask.objects.get(id=1)
                >>> pip_size = task.pip_size  # Always returns Decimal
          readOnly: true
        instrument:
          type: string
          description: Trading instrument (e.g., EUR_USD, USD_JPY)
          maxLength: 20
        trading_mode:
          allOf:
          - $ref: '#/components/schemas/TradingModeEnum'
          description: |-
            Trading mode: netting (aggregated positions) or hedging (independent trades)

            * `netting` - Netting Mode
            * `hedging` - Hedging Mode
        status:
          allOf:
          - $ref: '#/components/schemas/StatusEnum'
          readOnly: true
          description: |-
            Current task status

            * `created` - Created
            * `running` - Running
            * `stopped` - Stopped
            * `completed` - Completed
            * `failed` - Failed
        latest_execution:
          type: object
          additionalProperties: {}
          nullable: true
          description: Get summary of latest execution.
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was last updated
      required:
      - config_id
      - config_name
      - created_at
      - end_time
      - id
      - latest_execution
      - name
      - pip_size
      - start_time
      - status
      - strategy_type
      - updated_at
      - user_id
    BacktestTaskCreate:
      type: object
      description: Serializer for creating and updating BacktestTasks.
      properties:
        config:
          type: integer
          description: Strategy configuration used by this task
        name:
          type: string
          description: Human-readable name for this backtest task
          maxLength: 255
        description:
          type: string
          description: Optional description of this backtest task
        data_source:
          allOf:
          - $ref: '#/components/schemas/DataSourceEnum'
          description: |-
            Data source for historical tick data

            * `postgresql` - PostgreSQL
            * `athena` - AWS Athena
            * `s3` - AWS S3
        start_time:
          type: string
          format: date-time
          description: Start time for backtest period
        end_time:
          type: string
          format: date-time
          description: End time for backtest period
        initial_balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          description: Initial account balance for backtest
        commission_per_trade:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Commission to apply per trade
        pip_size:
          type: number
          format: double
          description: |-
            Get pip_size as Decimal with default value.

            Returns:
                Decimal: Pip size for the instrument, defaults to 0.01 if not set

            Example:
                >>> task = BacktestTask.objects.get(id=1)
                >>> pip_size = task.pip_size  # Always returns Decimal
          readOnly: true
        instrument:
          type: string
          description: Trading instrument (e.g., EUR_USD, USD_JPY)
          maxLength: 20
        trading_mode:
          allOf:
          - $ref: '#/components/schemas/TradingModeEnum'
          description: |-
            Trading mode: netting (aggregated positions) or hedging (independent trades)

            * `netting` - Netting Mode
            * `hedging` - Hedging Mode
      required:
      - config
      - pip_size
    BacktestTaskCreateRequest:
      type: object
      description: Serializer for creating and updating BacktestTasks.
      properties:
        config:
          type: integer
          description: Strategy configuration used by this task
        name:
          type: string
          minLength: 1
          description: Human-readable name for this backtest task
          maxLength: 255
        description:
          type: string
          description: Optional description of this backtest task
        data_source:
          allOf:
          - $ref: '#/components/schemas/DataSourceEnum'
          description: |-
            Data source for historical tick data

            * `postgresql` - PostgreSQL
            * `athena` - AWS Athena
            * `s3` - AWS S3
        start_time:
          type: string
          format: date-time
          description: Start time for backtest period
        end_time:
          type: string
          format: date-time
          description: End time for backtest period
        initial_balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          description: Initial account balance for backtest
        commission_per_trade:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Commission to apply per trade
        instrument:
          type: string
          minLength: 1
          description: Trading instrument (e.g., EUR_USD, USD_JPY)
          maxLength: 20
        trading_mode:
          allOf:
          - $ref: '#/components/schemas/TradingModeEnum'
          description: |-
            Trading mode: netting (aggregated positions) or hedging (independent trades)

            * `netting` - Netting Mode
            * `hedging` - Hedging Mode
      required:
      - config
    BacktestTaskList:
      type: object
      description: Serializer for BacktestTask list view (summary only).
      properties:
        id:
          type: integer
          readOnly: true
        user_id:
          type: integer
          readOnly: true
        config_id:
          type: integer
          readOnly: true
        config_name:
          type: string
          readOnly: true
        strategy_type:
          type: string
          readOnly: true
        name:
          type: string
          readOnly: true
          description: Human-readable name for this backtest task
        description:
          type: string
          readOnly: true
          description: Optional description of this backtest task
        data_source:
          allOf:
          - $ref: '#/components/schemas/DataSourceEnum'
          readOnly: true
          description: |-
            Data source for historical tick data

            * `postgresql` - PostgreSQL
            * `athena` - AWS Athena
            * `s3` - AWS S3
        start_time:
          type: string
          format: date-time
          readOnly: true
          description: Start time for backtest period
        end_time:
          type: string
          format: date-time
          readOnly: true
          description: End time for backtest period
        initial_balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
          description: Initial account balance for backtest
        pip_size:
          type: number
          format: double
          description: |-
            Get pip_size as Decimal with default value.

            Returns:
                Decimal: Pip size for the instrument, defaults to 0.01 if not set

            Example:
                >>> task = BacktestTask.objects.get(id=1)
                >>> pip_size = task.pip_size  # Always returns Decimal
          readOnly: true
        instrument:
          type: string
          readOnly: true
          description: Trading instrument (e.g., EUR_USD, USD_JPY)
        trading_mode:
          allOf:
          - $ref: '#/components/schemas/TradingModeEnum'
          readOnly: true
          description: |-
            Trading mode: netting (aggregated positions) or hedging (independent trades)

            * `netting` - Netting Mode
            * `hedging` - Hedging Mode
        status:
          allOf:
          - $ref: '#/components/schemas/StatusEnum'
          readOnly: true
          description: |-
            Current task status

            * `created` - Created
            * `running` - Running
            * `stopped` - Stopped
            * `completed` - Completed
            * `failed` - Failed
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was last updated
      required:
      - config_id
      - config_name
      - created_at
      - data_source
      - description
      - end_time
      - id
      - initial_balance
      - instrument
      - name
      - pip_size
      - start_time
      - status
      - strategy_type
      - trading_mode
      - updated_at
      - user_id
    DataSourceEnum:
      enum:
      - postgresql
      - athena
      - s3
      type: string
      description: |-
        * `postgresql` - PostgreSQL
        * `athena` - AWS Athena
        * `s3` - AWS S3
    DirectionEnum:
      enum:
      - long
      - short
      type: string
      description: |-
        * `long` - long
        * `short` - short
    JurisdictionEnum:
      enum:
      - US
      - JP
      - OTHER
      type: string
      description: |-
        * `US` - United States
        * `JP` - Japan
        * `OTHER` - Other/International
    OandaAccounts:
      type: object
      description: Serializer for OANDA account.
      properties:
        id:
          type: integer
          readOnly: true
        account_id:
          type: string
          description: OANDA account ID
          maxLength: 100
        api_type:
          allOf:
          - $ref: '#/components/schemas/ApiTypeEnum'
          description: |-
            API endpoint type (practice or live)

            * `practice` - Practice
            * `live` - Live
        jurisdiction:
          allOf:
          - $ref: '#/components/schemas/JurisdictionEnum'
          description: |-
            Regulatory jurisdiction for this account

            * `US` - United States
            * `JP` - Japan
            * `OTHER` - Other/International
        currency:
          type: string
          description: Account base currency
          maxLength: 3
        balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
          description: Current account balance
        margin_used:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
          description: Margin currently used by open positions
        margin_available:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
          description: Margin available for new positions
        unrealized_pnl:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          readOnly: true
          description: Unrealized profit/loss from open positions
        is_active:
          type: boolean
          description: Whether the account is active
        is_default:
          type: boolean
          description: Whether this is the default account for market data collection
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the account was added
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the account was last updated
      required:
      - account_id
      - balance
      - created_at
      - id
      - margin_available
      - margin_used
      - unrealized_pnl
      - updated_at
    OandaAccountsRequest:
      type: object
      description: Serializer for OANDA account.
      properties:
        account_id:
          type: string
          minLength: 1
          description: OANDA account ID
          maxLength: 100
        api_token:
          type: string
          writeOnly: true
          minLength: 1
          description: OANDA API token (will be encrypted)
        api_type:
          allOf:
          - $ref: '#/components/schemas/ApiTypeEnum'
          description: |-
            API endpoint type (practice or live)

            * `practice` - Practice
            * `live` - Live
        jurisdiction:
          allOf:
          - $ref: '#/components/schemas/JurisdictionEnum'
          description: |-
            Regulatory jurisdiction for this account

            * `US` - United States
            * `JP` - Japan
            * `OTHER` - Other/International
        currency:
          type: string
          minLength: 1
          description: Account base currency
          maxLength: 3
        is_active:
          type: boolean
          description: Whether the account is active
        is_default:
          type: boolean
          description: Whether this is the default account for market data collection
      required:
      - account_id
      - api_token
    OandaApiHealthStatus:
      type: object
      properties:
        id:
          type: integer
          readOnly: true
        account:
          type: integer
          readOnly: true
        oanda_account_id:
          type: string
          readOnly: true
        api_type:
          type: string
          readOnly: true
        is_available:
          type: boolean
          readOnly: true
        checked_at:
          type: string
          format: date-time
          readOnly: true
        latency_ms:
          type: integer
          readOnly: true
          nullable: true
        http_status:
          type: integer
          readOnly: true
          nullable: true
        error_message:
          type: string
          readOnly: true
      required:
      - account
      - api_type
      - checked_at
      - error_message
      - http_status
      - id
      - is_available
      - latency_ms
      - oanda_account_id
    OrderRequest:
      type: object
      description: Serializer for creating orders.
      properties:
        instrument:
          type: string
          minLength: 1
          description: Currency pair (e.g., 'EUR_USD')
          maxLength: 10
        order_type:
          allOf:
          - $ref: '#/components/schemas/OrderTypeEnum'
          description: |-
            Type of order

            * `market` - market
            * `limit` - limit
            * `stop` - stop
            * `oco` - oco
        direction:
          allOf:
          - $ref: '#/components/schemas/DirectionEnum'
          description: |-
            Trade direction

            * `long` - long
            * `short` - short
        units:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          description: Number of units to trade
        price:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
          description: Order price (required for limit/stop orders)
        take_profit:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
          description: Take-profit price
        stop_loss:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
          description: Stop-loss price
        limit_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
          description: Limit price (for OCO orders)
        stop_price:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
          description: Stop price (for OCO orders)
      required:
      - direction
      - instrument
      - order_type
      - units
    OrderTypeEnum:
      enum:
      - market
      - limit
      - stop
      - oco
      type: string
      description: |-
        * `market` - market
        * `limit` - limit
        * `stop` - stop
        * `oco` - oco
    PaginatedBacktestTaskListList:
      type: object
      required:
      - count
      - results
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/BacktestTaskList'
    PaginatedTradingTaskListList:
      type: object
      required:
      - count
      - results
      properties:
        count:
          type: integer
          example: 123
        next:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=4
        previous:
          type: string
          nullable: true
          format: uri
          example: http://api.example.org/accounts/?page=2
        results:
          type: array
          items:
            $ref: '#/components/schemas/TradingTaskList'
    PatchedBacktestTaskCreateRequest:
      type: object
      description: Serializer for creating and updating BacktestTasks.
      properties:
        config:
          type: integer
          description: Strategy configuration used by this task
        name:
          type: string
          minLength: 1
          description: Human-readable name for this backtest task
          maxLength: 255
        description:
          type: string
          description: Optional description of this backtest task
        data_source:
          allOf:
          - $ref: '#/components/schemas/DataSourceEnum'
          description: |-
            Data source for historical tick data

            * `postgresql` - PostgreSQL
            * `athena` - AWS Athena
            * `s3` - AWS S3
        start_time:
          type: string
          format: date-time
          description: Start time for backtest period
        end_time:
          type: string
          format: date-time
          description: End time for backtest period
        initial_balance:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
          description: Initial account balance for backtest
        commission_per_trade:
          type: string
          format: decimal
          pattern: ^-?\d{0,8}(?:\.\d{0,2})?$
          description: Commission to apply per trade
        instrument:
          type: string
          minLength: 1
          description: Trading instrument (e.g., EUR_USD, USD_JPY)
          maxLength: 20
        trading_mode:
          allOf:
          - $ref: '#/components/schemas/TradingModeEnum'
          description: |-
            Trading mode: netting (aggregated positions) or hedging (independent trades)

            * `netting` - Netting Mode
            * `hedging` - Hedging Mode
    PatchedTradingTaskCreateRequest:
      type: object
      description: |-
        Serializer for creating and updating TradingTask.

        Includes validation for account ownership and configuration.
      properties:
        config:
          type: integer
          description: Strategy configuration used by this task
        oanda_account:
          type: integer
          description: OANDA account used for trading
        name:
          type: string
          minLength: 1
          description: Human-readable name for this trading task
          maxLength: 255
        description:
          type: string
          description: Optional description of this trading task
        sell_on_stop:
          type: boolean
          description: Close all positions when task is stopped
    PositionRequest:
      type: object
      description: Serializer for opening a position via a market order.
      properties:
        instrument:
          type: string
          minLength: 1
          maxLength: 10
        direction:
          $ref: '#/components/schemas/DirectionEnum'
        units:
          type: string
          format: decimal
          pattern: ^-?\d{0,13}(?:\.\d{0,2})?$
        take_profit:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
        stop_loss:
          type: string
          format: decimal
          pattern: ^-?\d{0,5}(?:\.\d{0,5})?$
          nullable: true
      required:
      - direction
      - instrument
      - units
    PublicAccountSettings:
      type: object
      description: Serializer for public account settings (no authentication required).
      properties:
        registration_enabled:
          type: boolean
          description: Whether new user registration is enabled
        login_enabled:
          type: boolean
          description: Whether user login is enabled
        email_whitelist_enabled:
          type: boolean
          description: Whether email whitelist is enforced for registration/login
    StatusEnum:
      enum:
      - created
      - running
      - stopped
      - completed
      - failed
      type: string
      description: |-
        * `created` - Created
        * `running` - Running
        * `stopped` - Stopped
        * `completed` - Completed
        * `failed` - Failed
    TradingModeEnum:
      enum:
      - netting
      - hedging
      type: string
      description: |-
        * `netting` - Netting Mode
        * `hedging` - Hedging Mode
    TradingTask:
      type: object
      description: Serializer for TradingTask full details.
      properties:
        id:
          type: integer
          readOnly: true
        user_id:
          type: integer
          readOnly: true
        config_id:
          type: integer
          readOnly: true
        config_name:
          type: string
          readOnly: true
        strategy_type:
          type: string
          readOnly: true
        instrument:
          type: string
          description: Get instrument from configuration parameters.
          readOnly: true
        account_id:
          type: integer
          readOnly: true
        account_name:
          type: string
          readOnly: true
        account_type:
          type: string
          readOnly: true
        name:
          type: string
          description: Human-readable name for this trading task
          maxLength: 255
        description:
          type: string
          description: Optional description of this trading task
        sell_on_stop:
          type: boolean
          description: Close all positions when task is stopped
        status:
          allOf:
          - $ref: '#/components/schemas/StatusEnum'
          readOnly: true
          description: |-
            Current task status

            * `created` - Created
            * `running` - Running
            * `stopped` - Stopped
            * `completed` - Completed
            * `failed` - Failed
        latest_execution:
          type: object
          additionalProperties: {}
          nullable: true
          description: Get summary of latest execution with metrics.
          readOnly: true
        has_strategy_state:
          type: boolean
          description: Check if task has saved strategy state.
          readOnly: true
        can_resume:
          type: boolean
          description: Check if task can be resumed with state recovery.
          readOnly: true
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was last updated
      required:
      - account_id
      - account_name
      - account_type
      - can_resume
      - config_id
      - config_name
      - created_at
      - has_strategy_state
      - id
      - instrument
      - latest_execution
      - name
      - status
      - strategy_type
      - updated_at
      - user_id
    TradingTaskCreate:
      type: object
      description: |-
        Serializer for creating and updating TradingTask.

        Includes validation for account ownership and configuration.
      properties:
        config:
          type: integer
          description: Strategy configuration used by this task
        oanda_account:
          type: integer
          description: OANDA account used for trading
        name:
          type: string
          description: Human-readable name for this trading task
          maxLength: 255
        description:
          type: string
          description: Optional description of this trading task
        sell_on_stop:
          type: boolean
          description: Close all positions when task is stopped
    TradingTaskCreateRequest:
      type: object
      description: |-
        Serializer for creating and updating TradingTask.

        Includes validation for account ownership and configuration.
      properties:
        config:
          type: integer
          description: Strategy configuration used by this task
        oanda_account:
          type: integer
          description: OANDA account used for trading
        name:
          type: string
          minLength: 1
          description: Human-readable name for this trading task
          maxLength: 255
        description:
          type: string
          description: Optional description of this trading task
        sell_on_stop:
          type: boolean
          description: Close all positions when task is stopped
    TradingTaskList:
      type: object
      description: Serializer for TradingTask list view (summary only).
      properties:
        id:
          type: integer
          readOnly: true
        user_id:
          type: integer
          readOnly: true
        config_id:
          type: integer
          readOnly: true
        config_name:
          type: string
          readOnly: true
        strategy_type:
          type: string
          readOnly: true
        instrument:
          type: string
          description: Get instrument from configuration parameters.
          readOnly: true
        account_id:
          type: integer
          readOnly: true
        account_name:
          type: string
          readOnly: true
        account_type:
          type: string
          readOnly: true
        name:
          type: string
          readOnly: true
          description: Human-readable name for this trading task
        description:
          type: string
          readOnly: true
          description: Optional description of this trading task
        sell_on_stop:
          type: boolean
          readOnly: true
          description: Close all positions when task is stopped
        status:
          allOf:
          - $ref: '#/components/schemas/StatusEnum'
          readOnly: true
          description: |-
            Current task status

            * `created` - Created
            * `running` - Running
            * `stopped` - Stopped
            * `completed` - Completed
            * `failed` - Failed
        created_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was created
        updated_at:
          type: string
          format: date-time
          readOnly: true
          description: Timestamp when the task was last updated
      required:
      - account_id
      - account_name
      - account_type
      - config_id
      - config_name
      - created_at
      - description
      - id
      - instrument
      - name
      - sell_on_stop
      - status
      - strategy_type
      - updated_at
      - user_id
    UserLoginRequest:
      type: object
      description: Serializer for user login.
      properties:
        email:
          type: string
          format: email
          minLength: 1
          description: User's email address
        password:
          type: string
          writeOnly: true
          minLength: 1
          description: User's password
      required:
      - email
      - password
    UserRegistrationRequest:
      type: object
      description: Serializer for user registration.
      properties:
        email:
          type: string
          format: email
          minLength: 1
          description: User's email address (used for login)
          maxLength: 254
        username:
          type: string
          minLength: 1
          description: Username (auto-generated from email if not provided)
          pattern: ^[a-zA-Z0-9._-]+$
          maxLength: 150
        first_name:
          type: string
          maxLength: 150
        last_name:
          type: string
          maxLength: 150
        password:
          type: string
          writeOnly: true
          minLength: 1
          description: Password must be at least 8 characters long
        password_confirm:
          type: string
          writeOnly: true
          minLength: 1
          description: Confirm password
      required:
      - email
      - password
      - password_confirm
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: sessionid
servers:
- url: http://localhost:8000
  description: Development server
- url: https://api.autoforex.example.com
  description: Production server
tags:
- name: accounts
  description: User account management
- name: health
  description: System health checks
- name: market
  description: Market data and OANDA account management
- name: trading
  description: Trading tasks and execution management
- name: executions
  description: Execution data and metrics
